<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Migrate from iRedMail Easy to iRedMail Enterprise Edition</title>
        <link rel="stylesheet" type="text/css" href="./css/markdown.css" />
    </head>
    <body>

    <div id="navigation">
    <a href="https://www.iredmail.org" target="_blank">
        <img alt="iRedMail web site"
             src="./images/logo-iredmail.png"
             style="vertical-align: middle; height: 30px;"
             />&nbsp;
        <span>iRedMail</span>
    </a>
    &nbsp;&nbsp;//&nbsp;&nbsp;<a href="./index.html">Document Index</a></div><h1 id="migrate-from-iredmail-easy-to-iredmail-enterprise-edition">Migrate from iRedMail Easy to iRedMail Enterprise Edition</h1>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Check out the lightweight on-premises email archiving software developed by iRedMail team: <a href="https://spiderd.io/">Spider Email Archiver</a>.</p>
</div>
<div class="toc">
<ul>
<li><a href="#migrate-from-iredmail-easy-to-iredmail-enterprise-edition">Migrate from iRedMail Easy to iRedMail Enterprise Edition</a><ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#notes-before-getting-started">Notes before getting started</a></li>
<li><a href="#preparations">Preparations</a></li>
<li><a href="#migrate">Migrate</a></li>
<li><a href="#faq">FAQ</a><ul>
<li><a href="#dkim-signature-is-now-signed-by-the-new-milter-program">DKIM signature is now signed by the new milter program</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>iRedMail Team can help migrate your iRedMail server, feel free to
<a href="https://www.iredmail.org/contact.html">Contact Us</a>.</p>
</div>
<h2 id="summary">Summary</h2>
<p>iRedMail Enterprise Edition (<code>EE</code> for short) uses almost same deployment code
as iRedMail Easy, migrating from iRedMail Easy to EE is a breeze.</p>
<h2 id="notes-before-getting-started">Notes before getting started</h2>
<ul>
<li>An EE license is required. Please login or sign up to our website to get
  a trial license or purchase one: <a href="https://store.iredmail.org/">https://store.iredmail.org/</a>.</li>
</ul>
<h2 id="preparations">Preparations</h2>
<p>iRedAdmin and iRedAdmin-Pro are not available after migrated to iRedMail EE,
because iRedMail EE offers same features as iRedAdmin-Pro, hence
no need to run iRedAdmin(-Pro) after migrated.</p>
<p>Please login to server via ssh, make sure Nginx config snippet file
<code>/etc/nginx/templates/iredadmin.tmpl</code> is not included in other files:</p>
<pre><code class="language-shell">cd /etc/nginx/
grep -r 'iredadmin.tmpl' *
</code></pre>
<p>If <code>grep</code> command matches some files, please open them and remove the line
like <code>include /etc/nginx/templates/iredadmin.tmpl;</code>, then restart Nginx service.</p>
<h2 id="migrate">Migrate</h2>
<ul>
<li>Login to iRedMail Easy platform: <a href="https://easy.iredmail.org/">https://easy.iredmail.org/</a></li>
<li>Click <code>Mail Servers</code> on left sidebar.</li>
<li>Click <code>Export</code> button right beside the server hostname you want to migrate. It will display a modal window to show you the server settings.</li>
<li>Click <code>Copy</code> on the modal window to copy server settings in JSON format.</li>
<li>
<p>Follow <a href="./install.ee.html">the iRedMail EE installation tutorial</a> to download
  and launch EE on the server you deployed with iRedMail Easy platform.</p>
<p>EE launches the http service on port <code>8080</code>, please stop the firewall
temporarily so that you can access this port:</p>
<ul>
<li>on RHEL/CentOS/Rocky/Alma, run: <code>service firewalld stop</code></li>
<li>on Debian/Ubuntu, run: <code>service nftables stop</code></li>
<li>on OpenBSD, run: <code>pfctl -d</code></li>
</ul>
</li>
<li>
<p>Paste the copied server settings and paste below, then click <code>Migrate</code> button
  to import settings.</p>
</li>
<li>Click <code>Next</code> to review the settings.</li>
<li>Click <code>Migrate</code> to start the migration immediately. It should finish in seconds.</li>
<li>After migrated, access the new web UI <code>https://your-server/admin/</code>,
  login with same admin accounts you used to login to iRedAdmin or iRedAdmin-Pro.</li>
<li>After logged in, click <code>Deployments</code> on left sidebar, then click
  <code>Re-perform full deployment</code> to apply config file changes to fully migrated
  to iRedMail EE. Usually it finishes in just seconds.</li>
</ul>
<p>That's all.</p>
<p>If you experienced any issue, please report via the <a href="https://store.iredmail.org/tickets">Ticket system</a>.</p>
<p><img alt="" src="./images/ee/easy.to.ee-1.png" width="700px" />
<img alt="" src="./images/ee/easy.to.ee-2.png" width="700px" />
<img alt="" src="./images/ee/easy.to.ee-3.png" width="700px" /></p>
<h2 id="faq">FAQ</h2>
<h3 id="dkim-signature-is-now-signed-by-the-new-milter-program">DKIM signature is now signed by the new milter program</h3>
<ul>
<li>Existing DKIM keys were migrated by EE automatically during migration.</li>
<li>DKIM signature is now signed by the new milter program (<code>/usr/local/bin/milter*</code>), it's developed by iRedMail team.</li>
<li>DKIM keys are stored in SQL table <code>vmail.dkim</code>.</li>
<li>After login to EE as global admin, you can click the <code>DNS</code> badge on domain
  list page to check DNS records of the email domain, including DKIM key.</li>
<li>Feel free to generate DKIM key for each domain, then publish the public key on DNS.</li>
</ul><div class="footer">
    <p style="text-align: center; color: grey;">All documents are available in <a href="https://github.com/iredmail/docs/">GitHub repository</a>, and published under <a href="http://creativecommons.org/licenses/by-nd/3.0/us/" target="_blank">Creative Commons</a> license. You can <a href="https://github.com/iredmail/docs/archive/master.zip">download the latest version</a> for offline reading. If you found something wrong, please do <a href="https://www.iredmail.org/contact.html">contact us</a> to fix it.</p>
</div></body></html>